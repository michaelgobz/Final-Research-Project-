---
title: "Effects of the FDI on the Economic Growth of Uganda Time series Evidence"
output: html_notebook
---

The analysis bases on 4 variables

-   \- FDI stock

-   \- FDI Inflow

-   \- FDI Transactions (proxying it using REER)

-   \- FDI other Changes (Proxying it using net Foreign Assets)

-   \- GDP of Uganda

The time period for analysis is 1960 to 2021, with this raw data having missing values we need to correct for the missing values statistically.

Then raw data is in USD and Net foreign assets is in LCUs (local currency Units) which is converted to USD to make it uniform

**Setting The Analysis Environment**

Setup the packages required for analysis and load them requires the Rtools to build some of the packages download the binaries from here [Rtools](https://cran.r-project.org/bin/windows/Rtools/rtools42/rtools.html)

Install them

```{r install packages}
install.packages("AER")
install.packages("dynlm")
install.packages("forecast")
install.packages("readxl")
install.packages("stargazer")
install.packages("scales")
install.packages("quantmod")
install.packages("urca")

```

Load them into usage

```{r load the packages}
library(AER)
library(dynlm)
library(forecast)
library(readxl)
library(stargazer)
library(scales)
library(quantmod)
library(urca)
library(stats)

```

Load the data in from excel

```{r load the data in data.xlsx}
dataset <- read_xlsx("./data.xlsx",sheet = 4, col_types= "numeric")
dataset
```

Helper functions for Transformations

```{r helper functions}
# compute BIC for AR model objects of class 'dynlm'
BIC <- function(model) {
  ssr <- sum(model$residualsË†2)
  t <- length(model$residuals)
  npar <- length(model$coef)
  return(
    round(c("p" = npar - 1,
      "BIC" = log(ssr/t) + npar * log(t)/t,
      "R2" = summary(model)$r.squared), 4)
        )
}

# compute logarithms, annual growth rates and 1st lag of growth rates
quants <- function(series) {
    s <- series
      return(
        data.frame("Level" = s,
            "Logarithm" = log(s),
            "AnnualGrowthRate" = 100 * log(s / lag(s)),
            "1stLagAnnualGrowthRate" = lag(100 * log(s / lag(s))))
      )
}


```

**Plots of the variables with x-lab being 1960 to 2021 periods**

```{r Plots the variables}
#plot the lagged log values
GDP <- xts(dataset$`GDP$Millions`,order.by = as.Date(dataset$FY, origin = "1899-12-30" ,tryFormats=c("%Y-%m-%d")))
GDP_Growth <- xts(100 * log(GDP/lag(GDP)))
GDP_Growth
plot(as.zoo(GDP_Growth),
      col = "steelblue",
      lwd = 2,
      ylab = "Logarithm",
      xlab = "Period in years",
      main = "Ugandas GDP Growth"
)
```

**FDI Inflow**

```{r FDI Inflow }
# FDI inflow 

FDI_inflow <- xts(dataset$`FDI inflows$millions`,order.by = as.Date(dataset$FY, origin = "1899-12-30" ,tryFormats=c("%Y-%m-%d")))
FDI_Growth <- xts(100 * log(FDI_inflow/lag(FDI_inflow)))
FDI_Growth
plot(as.zoo(FDI_Growth),
      col = "steelblue",
      lwd = 2,
      ylab = "Logarithm",
      xlab = "Period in years",
      main = "Ugandas FDI Inflow Growth"
)
```

```{r FDI Stock }
# FDI Stock 

FDI_Stock <- xts(dataset$`FDI Stock$millions`,order.by = as.Date(dataset$FY, origin = "1899-12-30" ,tryFormats=c("%Y-%m-%d")))
FDI_Stock_Growth <- xts(100 * log(FDI_Stock/lag(FDI_Stock)))
FDI_Stock_Growth
plot(as.zoo(FDI_Stock_Growth),
      col = "steelblue",
      lwd = 2,
      ylab = "Logarithm",
      xlab = "Period in years",
      main = "Ugandas FDI Stock Growth"
)
```

**Excess of NFA (net Foreign Assets)**

```{r Excess of NFA }
# Excess of NFA 

NFA_d <- xts(dataset$`ExcessNFA$millions`,order.by = as.Date(dataset$FY, origin = "1899-12-30" ,tryFormats=c("%Y-%m-%d")))
NFA_Growth <- xts(100 * log(NFA_d/lag(NFA_d)))
NFA_Growth
plot(as.zoo(NFA_Growth),
      col = "steelblue",
      lwd = 2,
      ylab = "Logarithm",
      xlab = "Period in years",
      main = "Ugandas Excess of NFA of GDP Growth"
)
```

**REER (Real Effective Exchange Rate)**

```{r REER }
# REER 

REER<- xts(dataset$REER,order.by = as.Date(dataset$FY, origin = "1899-12-30" ,tryFormats=c("%Y-%m-%d")))
REER_Growth <- xts(100 * log(REER/lag(REER)))
REER_Growth
plot(as.zoo(REER_Growth),
      col = "steelblue",
      lwd = 2,
      ylab = "Logarithm",
      xlab = "Period in years",
      main = "Ugandas REER Growth"
)
```

**First level of Analysis** At this level of analysis, the autocorrelation between the different series shall be established then provide the narrative for the results

```{r ACF and PACF analysis of the series}
#the data sets
# REER
# NFA_d
# GDP
# FDI_inflow
# FDI_Stock
N <- length(GDP)
N

REER_level <- as.numeric(REER[-1])
REER_lags <-as.numeric(REER[-N])

#estimate model
REER_mod <- lm(REER_level ~ REER_lags)
REER_armod <- dynlm(ts(REER_level) ~ L(ts(REER_level)) + L(ts(REER_level), 2))

#robust summary
#coeftest(REER_armod, vcov. = vcovHC, type = "HC1")
coeftest(REER_armod, vcov. = sandwich)
#AR(2)
#summary(REER_armod)$sigma

acf(na.omit(REER), lag.max = 6, plot = T)
pacf(na.omit(REER),lag.max = 4, plot= T)

# then FIt AR(N) for N=4

# Use BIC to deteremine the lags
# Calculate the ACF and PACF 
```

**Testing and modeling using the ADL and testing for Predictability of the Regressors** At this level of analysis I shall fit a general regression model with multiple regressors which is an extension of the classical ADL model but with multiple Predictors. The mode is as follows, It uses p lags of the dependent variable and **ql** lags of **l** additional predictors where **l = 1, . . ., k** then applying the **Granger's Causality Tests** to a certain the predictive power the lags included in the model to predict the dependent variable Then Determine the Dynamic Causal Effects of the Regressors.

```{r ADL model and test for stationality and Predicatble powers}
```

**Fitting and ARIMAX model and Forecast the Default where h = 20** At this level, an ARIMAX model is fitted on the series to forecast the GDP based on the exogenous independent. The ARIMAX model is an extension of Auto regressive Integrated Moving Average (ARIMA) model. The ARIMA model has three parameters namely, p, d and q, where p is the autoregressive term, q is the moving average term and d indicated the series is differenced to make it stationary.

Regressions with non-stationary series are spurious and analyses are not valid. For this work, we test if there is stationarity by applying the Augmented Dickey-Fuller (ADF). Visually examining the autocorrelation function (ACF) and partial autocorrelation function (PACF) combined patterns should reveal some important features at least inconclusively which should help to identify the orders of AR and MA parameters of the model

```{r ARIMAX modeling}
```

**Narrative**
